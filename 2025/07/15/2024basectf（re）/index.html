

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Agent">
  <meta name="keywords" content="Crypto,Reverse,算法,编程技术,日常">
  
    <meta name="description" content="2024basectf（re）1.You are good at IDA![](屏幕截图 2025-04-15 131137.png) 用IDA打开文件，找到main先f5一下，然后再发现它让你shift+f12，所以试试，然后得到： ![](屏幕截图 2025-04-15 130555.png) 发现this is the second part，点击它，然后R之后，发现没有能R的东西，但是我们">
<meta property="og:type" content="article">
<meta property="og:title" content="2024BaseCTF（re）">
<meta property="og:url" content="http://tow-086.github.io/2025/07/15/2024basectf%EF%BC%88re%EF%BC%89/index.html">
<meta property="og:site_name" content="Agent的个人博客">
<meta property="og:description" content="2024basectf（re）1.You are good at IDA![](屏幕截图 2025-04-15 131137.png) 用IDA打开文件，找到main先f5一下，然后再发现它让你shift+f12，所以试试，然后得到： ![](屏幕截图 2025-04-15 130555.png) 发现this is the second part，点击它，然后R之后，发现没有能R的东西，但是我们">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://tow-086.github.io/image-20250706210342960.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706210412012.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706210442981.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706215119609.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706234849522.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706234910344.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706234950164.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250706235037266.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707151407732.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707151349739.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707180931063.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707180956066.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707181011691.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707181159001.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715172853547.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707233826969.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707233755702.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250707234720598.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250708150946361.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250708151005928.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250708150921288.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250708235335543.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250708235659056.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250709181739320.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250709181856243.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250709181921476.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710021743441.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710021838015.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710021914322.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710022355836.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710031436642.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710163848041.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710164036511.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710164143029.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710164210014.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710185653410.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710185721527.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710185753927.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250710204754663.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250713203309949.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715153611861.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715153522505.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715220300501.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715221505935.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231411811.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231444015.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231509964.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231530613.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231607081.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231632359.png">
<meta property="og:image" content="http://tow-086.github.io/image-20250715231649626-1752592610441-1.png">
<meta property="article:published_time" content="2025-07-15T04:00:00.000Z">
<meta property="article:modified_time" content="2025-08-03T10:18:09.609Z">
<meta property="article:author" content="Agent">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="逆向">
<meta property="article:tag" content="入门">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://tow-086.github.io/image-20250706210342960.png">
  
  
  
  <title>2024BaseCTF（re） - Agent的个人博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"tow-086.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Agent的个人博客" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2024BaseCTF（re）"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-15 12:00" pubdate>
          2025年7月15日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          59 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">2024BaseCTF（re）</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="2024basectf（re）"><a href="#2024basectf（re）" class="headerlink" title="2024basectf（re）"></a>2024basectf（re）</h1><h2 id="1-You-are-good-at-IDA"><a href="#1-You-are-good-at-IDA" class="headerlink" title="1.You are good at IDA"></a>1.You are good at IDA</h2><p>![](屏幕截图 2025-04-15 131137.png)</p>
<p>用IDA打开文件，找到main先f5一下，然后再发现它让你shift+f12，所以试试，然后得到：</p>
<p>![](屏幕截图 2025-04-15 130555.png)</p>
<p>发现this is the second part，点击它，然后R之后，发现没有能R的东西，但是我们发现：<code>DATA XREF:</code>显示了哪个函数使用了这个字符串，双击可以跳转到那个函数，然后R。</p>
<p>![](屏幕截图 2025-04-15 132125.png)</p>
<p>然后，发现他告诉你最后一个在Interesting，找到它然后R</p>
<p>![](屏幕截图 2025-04-15 131604.png)</p>
<p>得到flag：BaseCTF{Y0u_4Re_900d_47_id4}</p>
<h2 id="2-UPX-mini"><a href="#2-UPX-mini" class="headerlink" title="2.UPX mini"></a>2.UPX mini</h2><p>upx脱壳然后在ida里f5（反编译），然后发现这样：   &#x2F;&#x2F;至于为什么要先脱壳，那是因为，我搜到的用upx就是先脱壳，哦，忘了脱壳图片了，现在贴吧：</p>
<p>![](屏幕截图 2025-04-15 134839.png)</p>
<p>![](屏幕截图 2025-04-15 134542.png)</p>
<p>然后发现了一个base64格式的数据，&#x3D;&#x3D;填充了，直接解码：</p>
<p>![](屏幕截图 2025-04-15 134623.png)</p>
<p>得出flag：BaseCTF{Hav3_@_g0od_t1m3!!!}</p>
<h2 id="3-ez-maze-还没会-（现在会了）"><a href="#3-ez-maze-还没会-（现在会了）" class="headerlink" title="3.ez_maze(还没会)（现在会了）"></a>3.ez_maze(还没会)（现在会了）</h2><p>f5:然后发现自己不会，问完ai，继续看wp：</p>
<p>![](屏幕截图 2025-04-15 210900.png)</p>
<p>然后这是c语言代码，开始读代码，u1s1有点看不懂，所以我问ai了，这是一个15*15的迷宫，然后我们shift+e导出数据，导出了一个文件export_results.txt。是迷宫的数据，hex的ASCII文件。然后解码定行长整理后成这样：</p>
<p>这是工具：<a target="_blank" rel="noopener" href="https://www.toolhelper.cn/Char/TextLineSameLength">文本行定长 - 锤子在线工具</a></p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs crystal">x <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; &amp; &amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; <span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; <span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span>&amp; &amp; <span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br>&amp; &amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span>&amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; &amp; &amp; &amp; &amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span>&amp; <span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><br><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span><span class="hljs-variable">$ </span>&amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; y <br></code></pre></td></tr></table></figure>

<p>然后找到最短路径：sssssssddddwwwddsssssssdddsssddddd</p>
<p>之后发现一点思路没有，然后问了问Beck_，好像是因为自己没找到，然后再找找发现了：</p>
<p>![](屏幕截图 2025-05-08 202140.png)</p>
<p>找到了他说让我md5一下（别骂我，我刚开始学re），这是工具<a target="_blank" rel="noopener" href="https://www.sojson.com/md5/">MD5在线加密&#x2F;解密&#x2F;破解—MD5在线</a></p>
<p>解密出：131b7d6e60e8a34cb01801ae8de07efe</p>
<p>得出flag:BaseCTF{131b7d6e60e8a34cb01801ae8de07efe}</p>
<h2 id="4-BasePlus"><a href="#4-BasePlus" class="headerlink" title="4.BasePlus"></a>4.BasePlus</h2><p>先看函数都用了啥：</p>
<p>![](屏幕截图 2025-05-09 020848.png)</p>
<p>布拉布拉说了一堆，大概意思就是让我们根据密文解密解出flag，至于为什么是密文呢？因为我是学密码的大概能看出是密文，然后我直接base了，然后乱码，额，开看wp</p>
<p>发现她的encode函数：</p>
<p>![](屏幕截图 2025-05-09 020836.png)</p>
<p>对base64的结果进行了异或0xE，哦然后就简单了，我们直接先对密文异或回来，然后base64。base64失败，看到了他给的码表，以码表格式base64成功得出flag：</p>
<p><a target="_blank" rel="noopener" href="https://cyberchef.org/#recipe=To_Base64('A-Za-z0-9%2B/%3D'/disabled)XOR({'option':'Hex','string':'0xE'},'Standard',false)From_Base64('/128GhIoPQROSTeUbADfgHijKLM%2Bn0pFWXY456xyzB7%3D39VaqrstJklmNuZvwcdEC',true,false)&input=bHZmekJpWmlPdzc8bGhGOGRET2ZFYm1JXWlAYmRjWmZFY156PmFEIQ">To Base64, XOR, From Base64 - CyberChef</a></p>
<p>![](屏幕截图 2025-05-09 021632.png)</p>
<p>BaseCTF{BA5e_DEcoD1N6_sEcr3t}</p>
<h2 id="5-ez-xor"><a href="#5-ez-xor" class="headerlink" title="5.ez_xor"></a>5.ez_xor</h2><p>一个异或解密</p>
<p>秘钥：</p>
<ul>
<li><code>v4 = 7499608</code>（十六进制为0x00727F58）</li>
<li>密钥字节：<code>key = [0x58, 0x7F, 0x72]</code></li>
</ul>
<p>，秘钥流生成：</p>
<p>key_stream[i] &#x3D; i ^ key[i % 3]</p>
<p>对于位置<code>i</code>，使用密钥字节<code>key[i % 3]</code>与索引<code>i</code>异或</p>
<p>加密过程：</p>
<p>encrypted[i] &#x3D; flag[i] ^ key_stream[27 - i]</p>
<p>用户输入的每个字节与密钥流中对称位置的字节异或</p>
<p>目标字符串：</p>
<ul>
<li>28字节的固定值（从代码中提取）</li>
</ul>
<p>要获取flag就去执行逆过程：</p>
<p>flag[i] &#x3D; encrypted[i] ^ key_stream[27 - i]</p>
<p>主函数：</p>
<p><img src="/image-20250706210342960.png" srcset="/img/loading.gif" lazyload alt="image-20250706210342960"></p>
<p>秘钥流：</p>
<p><img src="/image-20250706210412012.png" srcset="/img/loading.gif" lazyload alt="image-20250706210412012"></p>
<p>加密函数：</p>
<p><img src="/image-20250706210442981.png" srcset="/img/loading.gif" lazyload alt="image-20250706210442981"></p>
<p>python脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 目标加密字符串（从反汇编代码中提取）</span><br>    encrypted_data = <span class="hljs-built_in">bytes</span>([<br>        <span class="hljs-number">0x01</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x1D</span>, <br>        <span class="hljs-number">0x24</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x67</span>,<br>        <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x34</span>,<br>        <span class="hljs-number">0x22</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x25</span><br>    ])<br>    <br>    <span class="hljs-comment"># 初始密钥（来自v4 = 7499608）</span><br>    v4 = <span class="hljs-number">7499608</span><br>    key_bytes = <span class="hljs-built_in">bytes</span>([v4 &amp; <span class="hljs-number">0xFF</span>, (v4 &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>, (v4 &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>])<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;逆向解密过程详解&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;1. 从 v4 = 7499608 (0x<span class="hljs-subst">&#123;v4:08X&#125;</span>) 提取密钥字节&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   key_bytes = [<span class="hljs-subst">&#123;<span class="hljs-string">&#x27;, &#x27;</span>.join(<span class="hljs-string">f&#x27;0x<span class="hljs-subst">&#123;b:02X&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> key_bytes)&#125;</span>]&quot;</span>)<br>    <br>    <span class="hljs-comment"># 生成密钥流</span><br>    key_stream = []<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n2. 生成密钥流 (key_stream[i] = i ^ key_bytes[i % 3]):&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted_data)):<br>        key_index = i % <span class="hljs-number">3</span><br>        key_byte = key_bytes[key_index]<br>        ks_byte = i ^ key_byte<br>        key_stream.append(ks_byte)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   i=<span class="hljs-subst">&#123;i:2d&#125;</span>, key_index=<span class="hljs-subst">&#123;key_index&#125;</span>, key_byte=0x<span class="hljs-subst">&#123;key_byte:02X&#125;</span>, &quot;</span><br>              <span class="hljs-string">f&quot;ks_byte = <span class="hljs-subst">&#123;i:2d&#125;</span> ^ 0x<span class="hljs-subst">&#123;key_byte:02X&#125;</span> = 0x<span class="hljs-subst">&#123;ks_byte:02X&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># 逆向计算flag</span><br>    flag = []<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n3. 计算flag (flag[i] = encrypted[i] ^ key_stream[27-i]):&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted_data)):<br>        reverse_index = <span class="hljs-built_in">len</span>(encrypted_data) - <span class="hljs-number">1</span> - i<br>        key_byte = key_stream[reverse_index]<br>        enc_byte = encrypted_data[i]<br>        flag_byte = enc_byte ^ key_byte<br>        flag.append(flag_byte)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   i=<span class="hljs-subst">&#123;i:2d&#125;</span>, rev_i=<span class="hljs-subst">&#123;reverse_index:2d&#125;</span>, &quot;</span><br>              <span class="hljs-string">f&quot;enc=0x<span class="hljs-subst">&#123;enc_byte:02X&#125;</span>, key=0x<span class="hljs-subst">&#123;key_byte:02X&#125;</span>, &quot;</span><br>              <span class="hljs-string">f&quot;flag_char=0x<span class="hljs-subst">&#123;flag_byte:02X&#125;</span> (&#x27;<span class="hljs-subst">&#123;<span class="hljs-built_in">chr</span>(flag_byte)&#125;</span>&#x27;)&quot;</span>)<br>    <br>    <span class="hljs-comment"># 转换为字符串</span><br>    flag_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> flag)<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;最终结果&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解密后的Flag: <span class="hljs-subst">&#123;flag_str&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># 验证过程</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;验证过程&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">50</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;重新加密flag以验证是否匹配目标字符串:&quot;</span>)<br>    <br>    <span class="hljs-comment"># 重新加密</span><br>    re_encrypted = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>        reverse_index = <span class="hljs-built_in">len</span>(flag) - <span class="hljs-number">1</span> - i<br>        key_byte = key_stream[reverse_index]<br>        enc_byte = flag[i] ^ key_byte<br>        re_encrypted.append(enc_byte)<br>        <span class="hljs-keyword">match</span> = <span class="hljs-string">&quot;✓&quot;</span> <span class="hljs-keyword">if</span> enc_byte == encrypted_data[i] <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;✗&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   i=<span class="hljs-subst">&#123;i:2d&#125;</span>, flag_char=&#x27;<span class="hljs-subst">&#123;<span class="hljs-built_in">chr</span>(flag[i])&#125;</span>&#x27;, &quot;</span><br>              <span class="hljs-string">f&quot;key=0x<span class="hljs-subst">&#123;key_byte:02X&#125;</span>, enc=0x<span class="hljs-subst">&#123;enc_byte:02X&#125;</span>, &quot;</span><br>              <span class="hljs-string">f&quot;target=0x<span class="hljs-subst">&#123;encrypted_data[i]:02X&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-keyword">match</span>&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">bytes</span>(re_encrypted) == encrypted_data:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n验证成功! 重新加密结果与目标字符串完全匹配&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n验证失败! 请检查解密过程&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>flag：BaseCTF{X0R_I5_345Y_F0r_y0U}</p>
<h2 id="6-UPX"><a href="#6-UPX" class="headerlink" title="6.UPX"></a>6.UPX</h2><p>脱壳后发现只有start，然后用010看到内部结构将小写改为大写再脱壳，得到exe分析</p>
<p><img src="/image-20250706215119609.png" srcset="/img/loading.gif" lazyload alt="image-20250706215119609"></p>
<p>脱壳然后：</p>
<p><img src="/image-20250706234849522.png" srcset="/img/loading.gif" lazyload alt="image-20250706234849522"></p>
<p>b64函数：</p>
<p><img src="/image-20250706234910344.png" srcset="/img/loading.gif" lazyload alt="image-20250706234910344"></p>
<p>map中这个：</p>
<p><img src="/image-20250706234950164.png" srcset="/img/loading.gif" lazyload alt="image-20250706234950164"></p>
<p>找到映射表，然后写代码解密：</p>
<p><img src="/image-20250706235037266.png" srcset="/img/loading.gif" lazyload alt="image-20250706235037266"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 自定义Base64解码实现 - 用于逆向工程中的特殊Base64编码</span><br><span class="hljs-comment"># 从工具中提取的自定义Base64映射表（前64个字符）</span><br><span class="hljs-comment"># 注意：原始字符串中有重复字符（如&#x27;A&#x27;），可能需要手动调整</span><br>custom_b64_map = <span class="hljs-string">&quot;A,.1fgvw#`/2ehux$~\&quot;3dity%_;4cjsz^+&#123;5bkrA&amp;=&#125;6alqB*-[70mpC()]89noX&quot;</span>[:<span class="hljs-number">64</span>]<br><br><span class="hljs-comment"># 标准Base64映射表（用于参考和转换）</span><br>standard_b64_map = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><span class="hljs-comment"># 构建反向映射表：将自定义字符映射到标准Base64的索引位置</span><br><span class="hljs-comment"># 例如：若自定义表中&#x27;$&#x27;在位置0，则reverse_map[&#x27;$&#x27;] = 0</span><br>reverse_map = &#123;c: i <span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(custom_b64_map)&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_b64decode</span>(<span class="hljs-params">ciphertext</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    使用自定义映射表解码Base64字符串</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    步骤：</span><br><span class="hljs-string">    1. 将每个自定义字符转换为对应的6位二进制值</span><br><span class="hljs-string">    2. 将所有6位二进制片段连接成完整的二进制字符串</span><br><span class="hljs-string">    3. 将二进制字符串按每8位分割，转换为字节数据</span><br><span class="hljs-string">    4. 尝试将字节数据解码为ASCII字符串</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 存储所有6位二进制片段的连接结果</span><br>    bits = <span class="hljs-string">&quot;&quot;</span><br>    <br>    <span class="hljs-comment"># 遍历密文中的每个字符</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ciphertext:<br>        <span class="hljs-comment"># 检查字符是否在自定义映射表中</span><br>        <span class="hljs-keyword">if</span> c <span class="hljs-keyword">in</span> reverse_map:<br>            <span class="hljs-comment"># 将字符转换为对应的6位二进制值（补前导零）</span><br>            <span class="hljs-comment"># 例如：索引0 -&gt; &#x27;000000&#x27;, 索引1 -&gt; &#x27;000001&#x27;, 依此类推</span><br>            bits += <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;reverse_map[c]:06b&#125;</span>&quot;</span><br>    <br>    <span class="hljs-comment"># 存储解码后的字节数据</span><br>    bytes_data = <span class="hljs-built_in">bytearray</span>()<br>    <br>    <span class="hljs-comment"># 将二进制字符串按每8位分割，转换为字节</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bits), <span class="hljs-number">8</span>):<br>        byte = bits[i:i+<span class="hljs-number">8</span>]<br>        <span class="hljs-comment"># 确保每次处理完整的8位（最后一组可能不足8位，需忽略）</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(byte) == <span class="hljs-number">8</span>:<br>            bytes_data.append(<span class="hljs-built_in">int</span>(byte, <span class="hljs-number">2</span>))<br>    <br>    <span class="hljs-comment"># 尝试将字节数据解码为ASCII字符串（CTF中常见的flag格式）</span><br>    <span class="hljs-comment"># 注意：如果flag包含非ASCII字符，这里可能需要尝试其他编码</span><br>    <span class="hljs-keyword">return</span> bytes_data.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br><br><span class="hljs-comment"># 待解码的目标密文（从逆向工程中获取）</span><br>ciphertext = <span class="hljs-string">&quot;$rg7_dhd~Alidg+zeyhz`vnz_d,7sy0=&quot;</span><br><br><span class="hljs-comment"># 调用自定义解码函数</span><br>plaintext = custom_b64decode(ciphertext)<br><br><span class="hljs-comment"># 输出解码结果</span><br><span class="hljs-built_in">print</span>(plaintext)<br><br><span class="hljs-comment"># 验证是否符合常见的CTF flag格式</span><br><span class="hljs-comment"># 例如：BaseCTF&#123;...&#125;, CTF&#123;...&#125;, flag&#123;...&#125;等</span><br><span class="hljs-comment"># 注意：需根据具体题目要求调整验证逻辑</span><br></code></pre></td></tr></table></figure>

<p>flag: BaseCTF{UPX_1s_$o_e@sy})</p>
<h2 id="7-lk"><a href="#7-lk" class="headerlink" title="7.lk"></a>7.lk</h2><p>对于这种超复杂的线性方程，我们可以用python的z3solver库解决</p>
<p>打断点调试：</p>
<p><img src="/image-20250707151407732.png" srcset="/img/loading.gif" lazyload alt="image-20250707151407732"></p>
<p><img src="/image-20250707151349739.png" srcset="/img/loading.gif" lazyload alt="image-20250707151349739"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 定义未知数</span><br>a = [Int(<span class="hljs-string">&#x27;a[%d]&#x27;</span> % i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">21</span>)]<br><br><span class="hljs-comment"># 创建求解器</span><br>s = Solver()<br><br><span class="hljs-comment"># 添加加权和的条件</span><br>s.add(<span class="hljs-number">948</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">887</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">410</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">978</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">417</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">908</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">965</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">987</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">141</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">257</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">323</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">931</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">773</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">851</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">758</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">891</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">575</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">616</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">860</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">283</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">913686</span>)<br>s.add( <span class="hljs-number">938</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">490</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">920</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">50</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">568</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">68</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">35</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">708</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">938</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">718</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">589</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">954</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">974</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">62</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">580</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">80</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">111</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">151</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">421</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">148</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">630335</span>)<br>s.add( <span class="hljs-number">908</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">590</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">668</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">222</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">489</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">335</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">778</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">622</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">95</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">920</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">932</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">892</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">409</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">392</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">11</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">113</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">948</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">674</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">506</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">182</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">707525</span>)<br>s.add( <span class="hljs-number">479</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">859</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">410</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">399</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">891</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">266</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">773</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">624</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">34</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">479</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">465</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">728</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">447</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">427</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">890</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">570</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">716</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">180</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">571</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">707</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">724203</span>)<br>s.add( <span class="hljs-number">556</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">798</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">380</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">716</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">71</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">901</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">949</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">304</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">142</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">679</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">459</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">814</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">282</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">49</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">873</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">169</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">437</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">199</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">771</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">807</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">688899</span>)<br>s.add( <span class="hljs-number">465</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">898</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">979</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">198</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">156</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">831</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">856</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">322</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">25</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">35</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">369</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">917</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">522</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">654</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">235</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">385</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">469</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">231</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">496</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">83</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">604784</span>)<br>s.add( <span class="hljs-number">305</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">928</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">260</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">793</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">787</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">708</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">758</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">236</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">688</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">747</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">711</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">195</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">50</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">648</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">787</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">376</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">220</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">33</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">194</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">585</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">665485</span>)<br>s.add( <span class="hljs-number">767</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">573</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">22</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">909</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">598</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">588</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">136</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">848</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">964</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">311</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">701</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">653</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">541</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">443</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">7</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">976</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">803</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">273</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">859</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">727664</span>)<br>s.add( <span class="hljs-number">776</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">59</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">507</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">164</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">397</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">744</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">377</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">768</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">456</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">799</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">9</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">215</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">365</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">181</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">634</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">818</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">81</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">236</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">883</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">95</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">572015</span>)<br>s.add( <span class="hljs-number">873</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">234</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">381</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">423</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">960</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">689</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">617</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">240</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">933</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">300</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">998</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">773</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">484</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">905</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">806</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">792</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">606</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">942</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">422</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">789</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">875498</span>)<br>s.add( <span class="hljs-number">766</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">7</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">283</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">900</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">211</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">305</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">343</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">696</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">590</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">736</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">817</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">603</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">414</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">828</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">114</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">845</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">175</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">212</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">898</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">988</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">714759</span>)<br>s.add( <span class="hljs-number">220</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">30</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">788</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">106</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">574</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">501</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">366</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">952</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">121</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">996</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">735</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">689</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">998</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">689</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">729</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">886</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">860</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">70</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">466</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">961</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">778853</span>)<br>s.add( <span class="hljs-number">313</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">748</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">522</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">864</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">156</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">362</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">283</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">49</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">316</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">79</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">136</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">299</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">271</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">604</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">907</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">540</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">141</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">620</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">701</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">866</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">584591</span>)<br>s.add( <span class="hljs-number">922</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">399</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">425</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">26</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">159</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">224</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">438</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">770</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">144</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">406</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">110</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">991</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">749</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">701</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">646</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">147</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">979</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">674</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">999</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">913</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">717586</span>)<br>s.add( <span class="hljs-number">13</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">537</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">225</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">421</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">153</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">484</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">654</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">743</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">779</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">74</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">325</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">439</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">797</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">41</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">784</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">269</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">454</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">725</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">164</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">537823</span>)<br>s.add( <span class="hljs-number">591</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">210</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">874</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">204</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">485</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">42</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">433</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">176</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">436</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">634</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">82</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">978</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">818</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">683</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">404</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">562</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">41</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">789</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">200</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">220</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">587367</span>)<br>s.add( <span class="hljs-number">584</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">597</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">928</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">532</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">902</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">858</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">820</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">240</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">124</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">899</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">848</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">822</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">409</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">491</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">587</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">715</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">410</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">268</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">721</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">915</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">842245</span>)<br>s.add( <span class="hljs-number">421</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">302</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">327</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">180</span> * a[<span class="hljs-number">17</span>]<br>     + a[<span class="hljs-number">16</span>] * <span class="hljs-number">512</span><br>     + <span class="hljs-number">160</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">623</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">28</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">411</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">53</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">633</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">560</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">623</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">477</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">901</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">287</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">149</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">726</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">934</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">875</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">610801</span>)<br>s.add( <span class="hljs-number">838</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">434</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">792</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">649</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">462</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">170</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">980</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">15</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">295</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">495</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">666</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">934</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">17</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">69</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">367</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">780</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">291</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">834</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">587</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">133</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">653127</span>)<br>s.add( <span class="hljs-number">41</span> * a[<span class="hljs-number">20</span>]<br>     + <span class="hljs-number">422</span> * a[<span class="hljs-number">19</span>]<br>     + <span class="hljs-number">420</span> * a[<span class="hljs-number">18</span>]<br>     + <span class="hljs-number">224</span> * a[<span class="hljs-number">17</span>]<br>     + <span class="hljs-number">475</span> * a[<span class="hljs-number">16</span>]<br>     + <span class="hljs-number">854</span> * a[<span class="hljs-number">15</span>]<br>     + <span class="hljs-number">233</span> * a[<span class="hljs-number">14</span>]<br>     + <span class="hljs-number">179</span> * a[<span class="hljs-number">13</span>]<br>     + <span class="hljs-number">620</span> * a[<span class="hljs-number">12</span>]<br>     + <span class="hljs-number">69</span> * a[<span class="hljs-number">11</span>]<br>     + <span class="hljs-number">42</span> * a[<span class="hljs-number">10</span>]<br>     + <span class="hljs-number">684</span> * a[<span class="hljs-number">9</span>]<br>     + <span class="hljs-number">300</span> * a[<span class="hljs-number">8</span>]<br>     + <span class="hljs-number">745</span> * a[<span class="hljs-number">7</span>]<br>     + <span class="hljs-number">894</span> * a[<span class="hljs-number">6</span>]<br>     + <span class="hljs-number">554</span> * a[<span class="hljs-number">5</span>]<br>     + <span class="hljs-number">495</span> * a[<span class="hljs-number">4</span>]<br>     + <span class="hljs-number">66</span> * a[<span class="hljs-number">3</span>]<br>     + <span class="hljs-number">316</span> * a[<span class="hljs-number">2</span>]<br>     + <span class="hljs-number">391</span> * a[<span class="hljs-number">1</span>] == <span class="hljs-number">533470</span> )<br><br><span class="hljs-comment"># 在求解器中添加字节的范围限制：0到255</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">21</span>):<br>    s.add(a[i] &gt;= <span class="hljs-number">0</span>, a[i] &lt;= <span class="hljs-number">255</span>)<br><br><span class="hljs-comment"># 检查是否有解</span><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    model = s.model()<br>    result = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(model[a[i]].as_long()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">21</span>)])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解是:&quot;</span>, result)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;没有解&quot;</span>)<br><br></code></pre></td></tr></table></figure>



<p>flag:  BaseCTF{CDBBDCAAABBDBCCBCCAC}</p>
<h2 id="8-喝杯下午茶"><a href="#8-喝杯下午茶" class="headerlink" title="8.喝杯下午茶"></a>8.喝杯下午茶</h2><p>主函数可以在这里找：</p>
<p><img src="/image-20250707180931063.png" srcset="/img/loading.gif" lazyload alt="image-20250707180931063"></p>
<p><img src="/image-20250707180956066.png" srcset="/img/loading.gif" lazyload alt="image-20250707180956066"></p>
<p><img src="/image-20250707181011691.png" srcset="/img/loading.gif" lazyload alt="image-20250707181011691"></p>
<p>大概是这样：</p>
<p><img src="/image-20250707181159001.png" srcset="/img/loading.gif" lazyload alt="image-20250707181159001"></p>
<p>v5是key，v6是密文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_block</span>(<span class="hljs-params">left, right, key</span>):<br>    k0, k1, k2, k3 = key<br>    delta = <span class="hljs-number">1131796</span><br>    total_delta = <span class="hljs-number">32</span> * delta<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        right = (right - ((k3 + (left &gt;&gt; <span class="hljs-number">5</span>)) ^ (left + total_delta) ^ (k2 + (left &lt;&lt; <span class="hljs-number">4</span>)))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        left = (left - ((k1 + (right &gt;&gt; <span class="hljs-number">5</span>)) ^ (right + total_delta) ^ (k0 + (right &lt;&lt; <span class="hljs-number">4</span>)))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        total_delta -= delta<br>    <span class="hljs-keyword">return</span> left, right<br><br><span class="hljs-comment"># Key and ciphertext</span><br>key = [<span class="hljs-number">0x11223344</span>, <span class="hljs-number">0x55667788</span>, <span class="hljs-number">0x99AABBCC</span>, <span class="hljs-number">0xDDEEFF11</span>]<br>ciphertext = [<br>    <span class="hljs-number">0x94B1F1E7</span>, <span class="hljs-number">0x21D5D352</span>,<br>    <span class="hljs-number">0x5247793D</span>, <span class="hljs-number">0x040D1C97</span>,<br>    <span class="hljs-number">0xF36E7F74</span>, <span class="hljs-number">0x9C53F70F</span>,<br>    <span class="hljs-number">0x6AEACFD8</span>, <span class="hljs-number">0x6F9F06F4</span>,<br>    <span class="hljs-number">0xEAFD9E2E</span>, <span class="hljs-number">0x32B655F7</span><br>]<br><br><span class="hljs-comment"># Decrypt each block</span><br>flag = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>):<br>    left, right = ciphertext[i], ciphertext[i+<span class="hljs-number">1</span>]<br>    dec_left, dec_right = decrypt_block(left, right, key)<br>    flag += dec_left.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br>    flag += dec_right.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(flag.decode())<br></code></pre></td></tr></table></figure>

<p>flag: BaseCTF{h3r3_4_cuP_0f_734_f0R_y0U!!!!!!}</p>
<h2 id="9-Ezpy"><a href="#9-Ezpy" class="headerlink" title="9.Ezpy"></a>9.Ezpy</h2><p>可以用网址：<a target="_blank" rel="noopener" href="https://tool.lu/">https://tool.lu/</a>   这个里的来解pyc</p>
<p>先转exe为pyc，再把pyc反编译成py。<strong>使用方法放到G:\Agent\Cybersecurity\reverse\un_python_gui了</strong></p>
<p><img src="/image-20250715172853547.png" srcset="/img/loading.gif" lazyload alt="image-20250715172853547"></p>
<p>一个简单的RC4加密解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">key = <span class="hljs-string">&#x27;yOU_f1nd_m3&#x27;</span><br>keykey = [<span class="hljs-number">66</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">101</span>]  <span class="hljs-comment"># 对应 &#x27;Base&#x27; 的 ASCII 码</span><br><br>enc = <span class="hljs-string">b&#x27;\xe6\xaeC~F\xf2\xe3\xbb\xac\x9a-\x02U\x85p\xeb\x19\xd1\xe4\xc93sG\xb0\xeb1\xb5\x05\x05\xc3\xd7\x00\x18+D\xbc\x0cO\x9em\xf1\xbd&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_Sbox</span>(<span class="hljs-params">seed</span>):<br>    k_b = [<span class="hljs-built_in">ord</span>(seed[i % <span class="hljs-built_in">len</span>(seed)]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>    s = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s[i] + k_b[i]) % <span class="hljs-number">256</span><br>        s[i], s[j] = s[j], s[i]<br>    <span class="hljs-keyword">return</span> s<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KeyStream</span>(<span class="hljs-params">length, Sbox</span>):<br>    s = Sbox.copy()<br>    i, j = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    k = [<span class="hljs-number">0</span>] * length<br>    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s[i]) % <span class="hljs-number">256</span><br>        s[i], s[j] = s[j], s[i]<br>        t = (s[i] + s[j]) % <span class="hljs-number">256</span><br>        k[r] = s[t] ^ keykey[r % <span class="hljs-built_in">len</span>(keykey)]<br>    <span class="hljs-keyword">return</span> k<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, seed</span>):<br>    Sbox = init_Sbox(seed)<br>    key = KeyStream(<span class="hljs-built_in">len</span>(ciphertext), Sbox)<br>    dec = [ciphertext[i] ^ key[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ciphertext))]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(dec)<br><br><span class="hljs-comment"># 执行解密</span><br>flag_bytes = decrypt(enc, key)<br><span class="hljs-keyword">try</span>:<br>    flag = flag_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag)<br><span class="hljs-keyword">except</span> UnicodeDecodeError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无法以UTF-8解码，原始字节:&quot;</span>, flag_bytes)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;尝试其他编码或查看字节内容...&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>flag：BaseCTF{Y0u_kn0W_d3C0Mp1l4710N_PY_4ND_rC4}</p>
<h2 id="10-最简单的编码"><a href="#10-最简单的编码" class="headerlink" title="10.最简单的编码"></a>10.最简单的编码</h2><p>先看主要逻辑：</p>
<p><img src="/image-20250707233826969.png" srcset="/img/loading.gif" lazyload alt="image-20250707233826969"></p>
<p>base换表和编码索引值+</p>
<p>获得魔改base，编码索引值+了那我们就减回去就行了</p>
<p><img src="/image-20250707233755702.png" srcset="/img/loading.gif" lazyload alt="image-20250707233755702"></p>
<p><img src="/image-20250707234720598.png" srcset="/img/loading.gif" lazyload alt="image-20250707234720598"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">table = <span class="hljs-string">&quot;CDABGHEFKLIJOPMNSTQRWXUVabYZefcdijghmnklqropuvstyzwx23016745+/89&quot;</span><br>enc = <span class="hljs-string">&quot;TqK1YUSaQryEMHaLMnWhYU+Fe0WPenqhRXahfkV6WE2fa3iRW197Za62eEaD&quot;</span><br>index = []<br>number = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    tmp = table.index(enc[i]) - number[i % <span class="hljs-number">4</span>]<br>    <span class="hljs-keyword">if</span> tmp &gt;= <span class="hljs-number">0</span>:<br>        index.append(tmp)<br>    <span class="hljs-keyword">else</span>:<br>        index.append(tmp + <span class="hljs-number">64</span>)<br><span class="hljs-built_in">print</span>(index)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(index),<span class="hljs-number">4</span>):<br>    a = index[i]<br>    b = index[i + <span class="hljs-number">1</span>]<br>    c = index[i + <span class="hljs-number">2</span>]<br>    d = index[i + <span class="hljs-number">3</span>]<br>    <span class="hljs-built_in">sum</span> = a &lt;&lt; <span class="hljs-number">18</span> | b &lt;&lt; <span class="hljs-number">12</span> | c &lt;&lt; <span class="hljs-number">6</span> | d<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">sum</span> &gt;&gt; ((<span class="hljs-number">2</span> - j) * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xff</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>flag：  BaseCTF{B45E64_eNCoDIn9_I5_rE4LLY_7OO_5implE}</p>
<p><strong><u><em>&#x3D;&#x3D;最终这个题我还是没做出来，因为环境问题：&#x3D;&#x3D;</em></u></strong></p>
<p><img src="/image-20250708150946361.png" srcset="/img/loading.gif" lazyload alt="image-20250708150946361"></p>
<p><img src="/image-20250708151005928.png" srcset="/img/loading.gif" lazyload alt="image-20250708151005928"></p>
<p><img src="/image-20250708150921288.png" srcset="/img/loading.gif" lazyload alt="image-20250708150921288"></p>
<h2 id="11-neuro爱数学"><a href="#11-neuro爱数学" class="headerlink" title="11.neuro爱数学"></a>11.neuro爱数学</h2><p>主要逻辑：</p>
<p><img src="/image-20250708235335543.png" srcset="/img/loading.gif" lazyload alt="image-20250708235335543"></p>
<p>逆向这个就可以了，然后我们扔给ai得到：x1到x9，然后再喂一下子就可以：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 定义多项式的根</span><br>    roots = [<span class="hljs-number">44</span>, <span class="hljs-number">58</span>, <span class="hljs-number">17</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">4</span>, -<span class="hljs-number">9</span>, -<span class="hljs-number">37</span>]<br>    <br>    <span class="hljs-comment"># 从根构建多项式</span><br>    poly_coeffs = np.poly(roots)<br>    <br>    <span class="hljs-comment"># 将系数四舍五入为整数</span><br>    integer_coeffs = [<span class="hljs-built_in">int</span>(<span class="hljs-built_in">round</span>(coeff)) <span class="hljs-keyword">for</span> coeff <span class="hljs-keyword">in</span> poly_coeffs]<br>    <br>    <span class="hljs-comment"># 验证关键系数</span><br>    <span class="hljs-keyword">assert</span> integer_coeffs[<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>, <span class="hljs-string">f&quot;i^8 系数应为 1，实际为 <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">0</span>]&#125;</span>&quot;</span><br>    <span class="hljs-keyword">assert</span> integer_coeffs[<span class="hljs-number">1</span>] == -<span class="hljs-number">80</span>, <span class="hljs-string">f&quot;i^7 系数应为 -80，实际为 <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">1</span>]&#125;</span>&quot;</span><br>    <span class="hljs-keyword">assert</span> integer_coeffs[<span class="hljs-number">2</span>] == -<span class="hljs-number">358</span>, <span class="hljs-string">f&quot;i^6 系数应为 -358，实际为 <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">2</span>]&#125;</span>&quot;</span><br>    <br>    <span class="hljs-comment"># 反转后的系数</span><br>    reversed_coeffs = integer_coeffs[::-<span class="hljs-number">1</span>]<br>    <br>    <span class="hljs-comment"># 打印多项式信息</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;多项式根:&quot;</span>, roots)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;多项式形式: P(i) = (i-44)(i-58)(i-17)(i-6)(i-5)(i+4)(i+9)(i+37)&quot;</span>)<br>    <br>    <span class="hljs-comment"># 打印原始系数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n多项式系数 (从最高次项到常数项):&quot;</span>)<br>    <span class="hljs-keyword">for</span> i, coeff <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(integer_coeffs):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;i^<span class="hljs-subst">&#123;<span class="hljs-number">8</span>-i&#125;</span> 的系数: <span class="hljs-subst">&#123;coeff&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># 打印反转后的系数</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n反转后的多项式系数 (从常数项到最高次项):&quot;</span>)<br>    <span class="hljs-keyword">for</span> i, coeff <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(reversed_coeffs):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;i^<span class="hljs-subst">&#123;i&#125;</span> 的系数: <span class="hljs-subst">&#123;coeff&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># 输出原始顺序的九个整数输入</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n原始顺序的九个整数输入:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">str</span>(coeff) <span class="hljs-keyword">for</span> coeff <span class="hljs-keyword">in</span> integer_coeffs))<br>    <br>    <span class="hljs-comment"># 输出反转顺序的九个整数输入</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n反转顺序的九个整数输入:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">str</span>(coeff) <span class="hljs-keyword">for</span> coeff <span class="hljs-keyword">in</span> reversed_coeffs))<br>    <br>    <span class="hljs-comment"># 提供复制方便的格式</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n复制以下内容直接输入到程序中 (原始顺序):&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">0</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">1</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">2</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">3</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">4</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">5</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">6</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">7</span>]&#125;</span> <span class="hljs-subst">&#123;integer_coeffs[<span class="hljs-number">8</span>]&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n复制以下内容直接输入到程序中 (反转顺序):&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">0</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">1</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">2</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">3</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">4</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">5</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">6</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">7</span>]&#125;</span> <span class="hljs-subst">&#123;reversed_coeffs[<span class="hljs-number">8</span>]&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p><img src="/image-20250708235659056.png" srcset="/img/loading.gif" lazyload alt="image-20250708235659056"></p>
<p>期间遇到了怎么绕过反反调试的问题，目前知道的解决办法：</p>
<p>1、改rax为0</p>
<p>2、在<a target="_blank" rel="noopener" href="https://github.com/notify-bibi/ScyllaHide-IDA7.5/tree/0.2">https://github.com/notify-bibi/ScyllaHide-IDA7.5/tree/0.2</a> 下载绕过反反调试的插件</p>
<p>flag： BaseCTF{neuro_11AdD8_result_21_filtered_ajar_boxfan}</p>
<h2 id="12-RivestCipher"><a href="#12-RivestCipher" class="headerlink" title="12.RivestCipher"></a>12.RivestCipher</h2><p>主函数：</p>
<p><img src="/image-20250709181739320.png" srcset="/img/loading.gif" lazyload alt="image-20250709181739320"></p>
<p>加密：</p>
<p><img src="/image-20250709181856243.png" srcset="/img/loading.gif" lazyload alt="image-20250709181856243"></p>
<p>解密：</p>
<p><img src="/image-20250709181921476.png" srcset="/img/loading.gif" lazyload alt="image-20250709181921476"></p>
<p>注意，这个题用的ida9.1，之前的题用的ida7.6</p>
<p>flag: BaseCTF{go1@ng_!S_RuNNin9_RC4}</p>
<h2 id="13-ezAndroid"><a href="#13-ezAndroid" class="headerlink" title="13.ezAndroid"></a>13.ezAndroid</h2><p>用jadx工具反编译apk得到Java程序：</p>
<p><img src="/image-20250710021743441.png" srcset="/img/loading.gif" lazyload alt="image-20250710021743441"></p>
<p>读懂这一部分发现是调其他的部分，过程大概是这样：</p>
<p><img src="/image-20250710021838015.png" srcset="/img/loading.gif" lazyload alt="image-20250710021838015"></p>
<p><img src="/image-20250710021914322.png" srcset="/img/loading.gif" lazyload alt="image-20250710021914322"></p>
<p>然后放到ida发现，是取地址然后异或运算：相同为零，不同为一</p>
<p>提取一下，然后py代码逆一下：</p>
<p><img src="/image-20250710022355836.png" srcset="/img/loading.gif" lazyload alt="image-20250710022355836"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">a=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>f=a.read()<br>m=[<span class="hljs-number">97</span>, <span class="hljs-number">54</span>, <span class="hljs-number">98</span>, <span class="hljs-number">52</span>, <span class="hljs-number">100</span>, <span class="hljs-number">52</span>, <span class="hljs-number">102</span>, <span class="hljs-number">101</span>, <span class="hljs-number">51</span>, <span class="hljs-number">52</span>, <span class="hljs-number">54</span>, <span class="hljs-number">49</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(f)):<br>     <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(f[i]^m[i%<span class="hljs-built_in">len</span>(m)]),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>



<p>也可以用这种方法：</p>
<p><img src="/image-20250710031436642.png" srcset="/img/loading.gif" lazyload alt="image-20250710031436642"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">Java.perform(()=&gt;&#123;<br>  <span class="hljs-type">let</span> <span class="hljs-variable">MainActivity</span> <span class="hljs-operator">=</span> Java.use(<span class="hljs-string">&quot;com.example.hello.MainActivity&quot;</span>);<br>MainActivity[<span class="hljs-string">&quot;loadFlagFile&quot;</span>].implementation = function (str) &#123;<br>    console.log(`MainActivity.loadFlagFile is called: str=$&#123;str&#125;`);<br>    <span class="hljs-type">let</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>[<span class="hljs-string">&quot;loadFlagFile&quot;</span>](str);<br>    console.log(`MainActivity.loadFlagFile result=$&#123;result&#125;`);<br>    <span class="hljs-keyword">var</span> A=Java.array(<span class="hljs-string">&#x27;byte&#x27;</span>,result);<br>    <span class="hljs-type">var</span> <span class="hljs-variable">B</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>[<span class="hljs-string">&quot;Base64encode&quot;</span>](A);<br>    console.log(`MainActivity.loadFlagFile Base64encode result=$&#123;B&#125;`);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;;<br>&#125;)<br></code></pre></td></tr></table></figure>



<p>flag:  BaseCTF{28e1bf5b-5a8e-4f7d-9afd-3991dfb28453}</p>
<h2 id="13-1额外知识点mobile"><a href="#13-1额外知识点mobile" class="headerlink" title="13.1额外知识点mobile"></a>13.1额外知识点mobile</h2><p><img src="/image-20250710163848041.png" srcset="/img/loading.gif" lazyload alt="image-20250710163848041"></p>
<p>开启雷电模拟器root权限，启动frida服务（在mobile里）</p>
<p>然后运行上面那个脚本：<br><img src="/image-20250710164036511.png" srcset="/img/loading.gif" lazyload alt="image-20250710164036511"></p>
<p>hook脚本是运行到包里的</p>
<p>然后用雷神模拟器输入任意内容就能出：</p>
<p><img src="/image-20250710164143029.png" srcset="/img/loading.gif" lazyload alt="image-20250710164143029"></p>
<p>然后ASCII查一下就可以了：</p>
<p><img src="/image-20250710164210014.png" srcset="/img/loading.gif" lazyload alt="image-20250710164210014"></p>
<p>flag:  BaseCTF{28e1bf5b-5a8e-4f7d-9afd-3991dfb28453}</p>
<h2 id="14-出题人已疯"><a href="#14-出题人已疯" class="headerlink" title="14.出题人已疯"></a>14.出题人已疯</h2><p>用die发现是c++编译的.net：</p>
<p><img src="/image-20250710185653410.png" srcset="/img/loading.gif" lazyload alt="image-20250710185653410"></p>
<p>然后：</p>
<p><img src="/image-20250710185721527.png" srcset="/img/loading.gif" lazyload alt="image-20250710185721527"></p>
<p><img src="/image-20250710185753927.png" srcset="/img/loading.gif" lazyload alt="image-20250710185753927"></p>
<p>找到关键方法，发现是三重异或</p>
<p>然后解密</p>
<p>解题逻辑：</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs excel">我们已知以下信息：<br><span class="hljs-number">1</span>. 密钥字符串 key_str 是由 sentences 数组中的所有字符串连接而成。<br><span class="hljs-number">2</span>. 目标数组 array3 是一个 uint 数组，实际存储的是字符的 <span class="hljs-built_in">Unicode</span> 编码（因为后面被转换为 <span class="hljs-built_in">char</span> 数组）。<br><span class="hljs-number">3</span>. 用户输入经过变换后与 array3 转换成的字符串进行比较。<br>变换过程：<br>   array[i] = (<span class="hljs-built_in">char</span>)( ( (array[i] * array[i]) ) ^ i ^ (<span class="hljs-built_in">int</span>)array2[i % array2.Length] )<br>逆向过程：<br>  设 <span class="hljs-built_in">T</span> = array3 中第 i 个元素转换成的字符的 <span class="hljs-built_in">Unicode</span> 值（即 target_chars[i] 的 ord）。<br>  变换后的值 <span class="hljs-built_in">T</span> 满足：<br>      <span class="hljs-built_in">T</span> = ( (input_char)² ) ^ i ^ key_char<br>因此，我们需要计算：<br>      (input_char)² = <span class="hljs-built_in">T</span> ^ i ^ key_char<br>然后开平方得到 input_char。<br>注意：由于 input_char 是一个 <span class="hljs-built_in">char</span> 类型，所以它的值在 <span class="hljs-number">0</span> 到 <span class="hljs-number">65535</span> 之间。开平方后取整，然后取整后的数值的平方应该等于计算出的值（否则可能出错，但根据算法，原始输入应该是可打印字符，所以通常不会超出范围）。<br>步骤：<br><span class="hljs-number">1</span>. 构造密钥字符串（key_str）。<br><span class="hljs-number">2</span>. 将 array3 中的每个 uint 转换为字符，然后获取其 <span class="hljs-built_in">Unicode</span> 码点（即整数）。<br><span class="hljs-number">3</span>. 对于每个位置 i：<br>      xor_triple = T_i ^ i ^ (key_str[i % <span class="hljs-built_in">len</span>(key_str)] 的码点)<br>      然后计算 <span class="hljs-built_in">sqrt</span>(xor_triple)，四舍五入取整，得到原始字符的码点。<br><span class="hljs-number">4</span>. 将码点转换为字符，连接起来得到 flag。<br>注意：由于平方操作，原始字符的码点必须是一个整数，并且其平方必须在 <span class="hljs-number">0</span> 到 <span class="hljs-number">65535</span> 之间，所以原始字符的码点范围在 <span class="hljs-number">0</span> 到 <span class="hljs-number">255</span> 之间（因为 <span class="hljs-number">256</span>*<span class="hljs-number">256</span>=<span class="hljs-number">65536</span>，超出 <span class="hljs-built_in">char</span> 范围，所以实际上原始字符应该是 ASCII 或 Latin-<span class="hljs-number">1</span> 字符，因为中文字符的码点较大，平方会溢出）。但实际上，array3 中的值都是小于 <span class="hljs-number">65536</span> 的，所以原始字符的码点不会超过 <span class="hljs-number">255</span>（因为平方后最大为 <span class="hljs-number">255</span>^<span class="hljs-number">2</span>=<span class="hljs-number">65025</span>，小于<span class="hljs-number">65536</span>）。因此，我们只需要考虑 <span class="hljs-number">0</span>~<span class="hljs-number">255</span> 的字符。<br>但是，注意：变换后的值 <span class="hljs-built_in">T</span> 是 <span class="hljs-built_in">char</span>，所以 <span class="hljs-built_in">T</span> 在 <span class="hljs-number">0</span>~<span class="hljs-number">65535</span> 之间，而 key_char 也是 <span class="hljs-built_in">char</span>（<span class="hljs-number">0</span>~<span class="hljs-number">65535</span>），所以计算出的平方值（即 xor_triple）可能很大，但实际在逆向时，我们得到 xor_triple 后开平方，然后取整，再检查取整后的数值的平方是否等于 xor_triple（因为平方取整会有精度损失）。如果不相等，则说明该位置无解。但根据算法，正确的输入应该是有解的。<br>编写完整代码：<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><br><span class="hljs-comment"># 定义干扰字符串数组（sentences）</span><br>sentences = [<br>    <span class="hljs-string">&quot;你以为我还会在乎吗？\ud83d\ude2c\ud83d\ude2c\ud83d\ude2c我在昆仑山练了六年的剑\ud83d\ude1f\ud83d\ude1f\ud83d\ude1f我的心早就和昆仑山的雪一样冷了\ud83d\ude10\ud83d\ude10\ud83d\ude10我在大润发杀了十年的鱼\ud83d\ude2b\ud83d\ude2b\ud83d\ude2b我以为我的心早已跟我的刀一样冷了\ud83d\ude29\ud83d\ude29\ud83d\ude29&quot;</span>,<br>    <span class="hljs-string">&quot;我早上坐公交滴卡的时候和司机大叔说“两个人”，司机惊讶地看着我“你明明就是一个人，为什么要滴两个人的卡？”我回他，“我心中还有一个叫Kengwang的。”司机回我说，“天使是不用收钱的。”&quot;</span>,<br>    <span class="hljs-string">&quot;（尖叫）（扭曲）（阴暗的爬行）（扭动）（阴暗地蠕动）（翻滚）（激烈地爬动）（痉挛）（嘶吼）（蠕动）（阴森的低吼）（爬行）（分裂）（走上岸）（扭曲的行走）（不分对象攻击）&quot;</span>,<br>    <span class="hljs-string">&quot;地球没我照样转？硬撑罢了！地球没我照样转？硬撑罢了！地球没我照样转？硬撑罢了！地球没我照样转？硬撑罢了！地球没我照样转？硬撑罢了！地球没我照样转？硬撑罢了！&quot;</span>,<br>    <span class="hljs-string">&quot;扭曲上勾拳！阴暗的下勾拳！尖叫左勾拳！右勾拳爬行！扭动扫堂腿！分裂回旋踢！这是蜘蛛阴暗的吃耳屎，这是龙卷风翻滚停车场！乌鸦痉挛！老鼠嘶吼！大象蠕动！愤怒的章鱼！无差别攻击！无差别攻击！无差别攻击！&quot;</span><br>]<br><br><span class="hljs-comment"># 连接所有干扰字符串形成密钥</span><br>key_str = <span class="hljs-string">&#x27;&#x27;</span>.join(sentences)<br>key_chars = <span class="hljs-built_in">list</span>(key_str)  <span class="hljs-comment"># 转换为字符数组</span><br>key_length = <span class="hljs-built_in">len</span>(key_chars)<br><br><span class="hljs-comment"># 目标验证数据（从 array3 复制）</span><br>target_uint = [<br>    <span class="hljs-number">24164</span>, <span class="hljs-number">27173</span>, <span class="hljs-number">32145</span>, <span class="hljs-number">17867</span>, <span class="hljs-number">40533</span>, <span class="hljs-number">21647</span>, <span class="hljs-number">17418</span>, <span class="hljs-number">30032</span>, <span class="hljs-number">27950</span>, <span class="hljs-number">62998</span>,<br>    <span class="hljs-number">60750</span>, <span class="hljs-number">64870</span>, <span class="hljs-number">52680</span>, <span class="hljs-number">61797</span>, <span class="hljs-number">49234</span>, <span class="hljs-number">59762</span>, <span class="hljs-number">16704</span>, <span class="hljs-number">19200</span>, <span class="hljs-number">32132</span>, <span class="hljs-number">24038</span>,<br>    <span class="hljs-number">21764</span>, <span class="hljs-number">30130</span>, <span class="hljs-number">28113</span>, <span class="hljs-number">23070</span>, <span class="hljs-number">27413</span>, <span class="hljs-number">27917</span>, <span class="hljs-number">28938</span>, <span class="hljs-number">50207</span>, <span class="hljs-number">64834</span>, <span class="hljs-number">60132</span>,<br>    <span class="hljs-number">64832</span>, <span class="hljs-number">63334</span>, <span class="hljs-number">55103</span>, <span class="hljs-number">22176</span>, <span class="hljs-number">21991</span>, <span class="hljs-number">20073</span>, <span class="hljs-number">22281</span>, <span class="hljs-number">19476</span>, <span class="hljs-number">28302</span>, <span class="hljs-number">24336</span>,<br>    <span class="hljs-number">24720</span>, <span class="hljs-number">19544</span>, <span class="hljs-number">23018</span>, <span class="hljs-number">43976</span><br>]<br><br><span class="hljs-comment"># 将目标 uint 数组转换为字符数组</span><br>target_chars = [<span class="hljs-built_in">chr</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> target_uint]<br><br><span class="hljs-comment"># 逆向计算 flag</span><br>flag_chars = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(target_chars)):<br>    <span class="hljs-comment"># 获取目标字符的 Unicode 码点</span><br>    transformed_val = <span class="hljs-built_in">ord</span>(target_chars[i])<br>    <br>    <span class="hljs-comment"># 获取对应位置的密钥字符</span><br>    key_val = <span class="hljs-built_in">ord</span>(key_chars[i % key_length])<br>    <br>    <span class="hljs-comment"># 逆向计算三重异或</span><br>    <span class="hljs-comment"># 原始公式: transformed_val = (input_char²) ^ i ^ key_val</span><br>    <span class="hljs-comment"># 因此: input_char² = transformed_val ^ i ^ key_val</span><br>    xor_result = transformed_val ^ i ^ key_val<br>    <br>    <span class="hljs-comment"># 开平方逆向计算原始字符值</span><br>    <span class="hljs-comment"># 由于字符值必须是整数，四舍五入后取整</span><br>    original_val = <span class="hljs-built_in">round</span>(math.sqrt(xor_result))<br>    <br>    <span class="hljs-comment"># 验证计算结果是否有效</span><br>    <span class="hljs-keyword">if</span> original_val * original_val != xor_result:<br>        <span class="hljs-comment"># 如果验证失败，尝试寻找最接近的整数解</span><br>        candidates = []<br>        <span class="hljs-keyword">for</span> candidate <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, original_val - <span class="hljs-number">2</span>), <span class="hljs-built_in">min</span>(<span class="hljs-number">0xFFFF</span>, original_val + <span class="hljs-number">3</span>)):<br>            <span class="hljs-keyword">if</span> candidate * candidate == xor_result:<br>                candidates.append(candidate)<br>        <br>        <span class="hljs-keyword">if</span> candidates:<br>            <span class="hljs-comment"># 优先选择可打印字符</span><br>            <span class="hljs-keyword">for</span> cand <span class="hljs-keyword">in</span> candidates:<br>                <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= cand &lt;= <span class="hljs-number">126</span>:  <span class="hljs-comment"># ASCII 可打印字符范围</span><br>                    original_val = cand<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span>:<br>                original_val = candidates[<span class="hljs-number">0</span>]  <span class="hljs-comment"># 没有可打印字符则取第一个解</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># 没有精确解时使用近似值（这种情况在正确输入下不应发生）</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;警告: 位置 <span class="hljs-subst">&#123;i&#125;</span> 无精确解，使用近似值 <span class="hljs-subst">&#123;original_val&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># 将数值转换回字符</span><br>    flag_chars.append(<span class="hljs-built_in">chr</span>(original_val))<br><br><span class="hljs-comment"># 组合最终 flag</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join(flag_chars)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解密后的 Flag:&quot;</span>, flag)<br></code></pre></td></tr></table></figure>





<p>flag： BaseCTF{y0u_KnOw_UTF16_6uT_U_r_n0t_Cr@zym@n}</p>
<h2 id="15-UPX-PRO"><a href="#15-UPX-PRO" class="headerlink" title="15.UPX PRO"></a>15.UPX PRO</h2><p>有壳，脱壳失败，010看一下，改4F为F4：</p>
<p><img src="/image-20250710204754663.png" srcset="/img/loading.gif" lazyload alt="image-20250710204754663"></p>
<p>看加密逻辑：</p>
<p><img src="/image-20250713203309949.png" srcset="/img/loading.gif" lazyload alt="image-20250713203309949"></p>
<p> 基本确定就是RC4，不过是把加密的轮数从256改成了128了。那么有了密钥，以及加密结果，就可以写解密脚本了。</p>
<p> 这里还需要注意的是在写解密脚本的时候，ida反汇编出来的加密数据是小端序排列，我们在写解密脚本的时候需要用大端序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">s, k2, Len_k2</span>):<br>    k = [<span class="hljs-number">0</span>] * <span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        s[i] = i<br>        <span class="hljs-comment"># 完全匹配 C++ 代码的写法：k[i] = k[i % Len_k2]</span><br>        <span class="hljs-comment"># 在 Python 中，由于 k 初始化为全零，这等同于 k[i] = 0</span><br>        k[i] = k[i % Len_k2]<br>    <br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        j = (j + s[i] + k[i]) % <span class="hljs-number">128</span><br>        s[i], s[j] = s[j], s[i]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">c4_decrypt</span>(<span class="hljs-params">Data, Len_D, k1, Len_k1</span>):<br>    s = [<span class="hljs-number">0</span>] * <span class="hljs-number">128</span><br>    init(s, k1, Len_k1)<br>    i = j = <span class="hljs-number">0</span><br>    <br>    decrypted = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Len_D):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">128</span><br>        j = (j + s[i]) % <span class="hljs-number">128</span><br>        s[i], s[j] = s[j], s[i]<br>        t = (s[i] + s[j]) % <span class="hljs-number">128</span><br>        <span class="hljs-comment"># 直接修改 Data 中的字节</span><br>        Data[k] ^= s[t]<br>    <br>    <span class="hljs-keyword">return</span> Data<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># 密钥（必须与C++完全一致）</span><br>    key = <span class="hljs-string">b&quot;B2a0s2e40815&quot;</span><br>    <span class="hljs-built_in">print</span>(key.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>))<br>    <br>    key_len = <span class="hljs-built_in">len</span>(key)<br>    <span class="hljs-comment"># 加密数据（与C++代码完全一致）</span><br>    encrypted_data = <span class="hljs-built_in">bytearray</span>([<br>        <span class="hljs-number">0x16</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x21</span>,<br>        <span class="hljs-number">0x08</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x5a</span>,<br>        <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x7c</span>,<br>        <span class="hljs-number">0x64</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x74</span><br>    ])<br>    <br>    <span class="hljs-comment"># 解密</span><br>    decrypted = c4_decrypt(encrypted_data, <span class="hljs-built_in">len</span>(encrypted_data), key, key_len)<br>    <br>    <span class="hljs-comment"># 输出结果（逐字符打印，与C++完全一致）</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解密结果：&quot;</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> decrypted:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(b), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br>    <br>    <span class="hljs-comment"># 十六进制输出</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n十六进制形式：&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:02x&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> decrypted))<br></code></pre></td></tr></table></figure>

<p>flag： BaseCTF{Rc4_1$_@_G0od_3nCrypt!on_MethOd}</p>
<h2 id="16-Dont-debug-me"><a href="#16-Dont-debug-me" class="headerlink" title="16.Dont-debug-me"></a>16.Dont-debug-me</h2><p>下断点动调一下：</p>
<p><img src="/image-20250715153611861.png" srcset="/img/loading.gif" lazyload alt="image-20250715153611861"></p>
<p>读读函数然后发现会按反调试走，那我们就可以：到了这，0000000000401F7D这一行的jz语句下方的两个箭头，右边这个在闪动，意思是下一步程序会往箭头所指的方向运行，那就是结束程序了，那么我们可以选择修改标志位寄存器，ZF，来进行绕过，</p>
<p>双击ZF的值，就可以修改了，修改为0就好了</p>
<p><img src="/image-20250715153522505.png" srcset="/img/loading.gif" lazyload alt="image-20250715153522505"></p>
<p>flag：  BaseCTF{8ea2710a717f89d83af695d312fe3b625df14a6ba6b3a74e15ed1e2d35cb10}</p>
<h2 id="17-UPX-PRO-MAX"><a href="#17-UPX-PRO-MAX" class="headerlink" title="17.UPX PRO MAX"></a>17.UPX PRO MAX</h2><p>发现加壳且标志位被改为0：</p>
<p><img src="/image-20250715220300501.png" srcset="/img/loading.gif" lazyload alt="image-20250715220300501"></p>
<p>x64dbg打开程序，先F9运行，</p>
<p>再按几次F8，可以看到很明显就是ESP定律</p>
<p><img src="/image-20250715221505935.png" srcset="/img/loading.gif" lazyload alt="image-20250715221505935"></p>
<p>鼠标光标放到RSP寄存器上，右键，</p>
<p><img src="/image-20250715231411811.png" srcset="/img/loading.gif" lazyload alt="image-20250715231411811">点击在内存窗口中转到，然后右键，选择断点-&gt;硬件，访问-&gt;4字节，接着按几次F9运行，可以看到，</p>
<p><img src="/image-20250715231444015.png" srcset="/img/loading.gif" lazyload alt="image-20250715231444015"></p>
<p><img src="/image-20250715231509964.png" srcset="/img/loading.gif" lazyload alt="image-20250715231509964"></p>
<p>第一个红色方框中的多个pop就说明解压已经结束，正要恢复现场，第二个红色方框中就是OEP了，然后我们只需F8通过jmp跳到正确有效函数的入口，</p>
<p><img src="/image-20250715231530613.png" srcset="/img/loading.gif" lazyload alt="image-20250715231530613"></p>
<p>跳转到这，我们就可以使用插件 <strong>scylla</strong> 进行脱壳了，</p>
<p>好像可以在这里直接改：</p>
<p><img src="/image-20250715231607081.png" srcset="/img/loading.gif" lazyload alt="image-20250715231607081"></p>
<p>可以看到使用插件，进程已经填好，OEP也填好了，我们只需点击Dump，然后保存好文件，</p>
<p>再点击IAT Autosearch,</p>
<p><img src="/image-20250715231632359.png" srcset="/img/loading.gif" lazyload alt="image-20250715231632359"></p>
<p>看到IAT已找到，再点击Get Imports，</p>
<p><img src="/image-20250715231649626-1752592610441-1.png" srcset="/img/loading.gif" lazyload alt="image-20250715231649626"></p>
<p>那个打叉的函数不管，另外三个是正常的，最后点击Fix Dump，选择我们刚才Dump下来的文件就可以了。最后分析的时候我们分析的是修复好的文件，<strong>UPX PRO MAX_dump_SCY.exe</strong></p>
<p>然后剩下的正常逆，发现是一个异或运算，直接套：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 从C++代码中提取的加密数组</span><br>enc = [<span class="hljs-number">0x22</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x5C</span>,<br>       <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x34</span>,<br>       <span class="hljs-number">0x64</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x6D</span>,<br>       <span class="hljs-number">0x43</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x52</span>,<br>       <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x29</span>]<br><br><span class="hljs-comment"># 第一步：执行累积异或操作（从后向前）</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">41</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    enc[i - <span class="hljs-number">1</span>] ^= enc[i]<br><br><span class="hljs-comment"># 第二步：执行最终异或操作并构建flag</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(enc[j] ^ j ^ <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;&#125;&#x27;</span>)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">42</span>)])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解出的flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>



<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">flag:   BaseCTF&#123;W3lC0M3_2_ReV3r$e_xOr_1s_$O_e<span class="hljs-symbol">@S</span>|!&#125;<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  
    <span>></span>
    
  <a href="/categories/CTF/%E9%80%86%E5%90%91/" class="category-chain-item">逆向</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
        <a href="/tags/%E9%80%86%E5%90%91/" class="print-no-link">#逆向</a>
      
        <a href="/tags/%E5%85%A5%E9%97%A8/" class="print-no-link">#入门</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2024BaseCTF（re）</div>
      <div>http://tow-086.github.io/2025/07/15/2024basectf（re）/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Agent</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年7月15日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/27/2024-2025%E4%B8%80%E5%AD%A6%E5%B9%B4%E7%9A%84%E6%80%BB%E7%BB%93/" title="2024-2025一学年的总结">
                        <span class="hidden-mobile">2024-2025一学年的总结</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
